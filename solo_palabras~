#!/bin/bash

# crea solo palabras del log
in="$1"
canal="$2"
usuario="$3"
#filtro='[,:.\"\}\^\=\#\*\/\\]'
filtro='[,]'
min_len=2
if [ ! -f "$in" ]; then
	echo "File not found! '$in'"
	echo "Usage: $0 <archivo_log>"
	exit
fi
echo 
while IFS= read -r line; do
	if [ "$usuario" ]; then
		words=$(echo "$line" | grep "$usuario" | awk '{$1=$2=$3=$4=$5=$6=""; print $0}')
	else
		words=$(echo "$line" | grep "$canal" | awk '{$1=$2=$3=$4=$5=$6=""; print $0}')
	fi
	words=${words//$filtro}
	
	for i in $words; do
		i="${i/ /}"
		if [[ "${#i}" -gt "$min_len" ]]; then
			echo -n "$i "
		fi
	done
done < "$in"
echo;echo
